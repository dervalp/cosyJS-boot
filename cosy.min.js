!function(a){"use strict";var b,c=[],d="undefined"!=typeof window,e={},f=a.__cosy_config||{},g=f.deferred,h="cosy-type",i="cosy-id",j="app",k="["+h+"]",l="["+j+"]",m=Array.isArray,n={},o=(Array.prototype.forEach,d&&f.conf?f.conf:{}),p=f.controllers?f.controllers:[],q=function(a){for(var b=[],c=a.length>>>0;c--;)b[c]=a[c];return b},r=function(a,b){var c=a,d=null,e=0;for(b&&(d=b.id);c.parentNode!==d;)c=c.parentNode,e++;return e},s=function(){console.log(arguments)},t=function(a,b){var c=document.createElement("script");c.src=a,c.onload=b,c.onerror=s,(document.head||document.getElementsByTagName("head")[0]).appendChild(c)},u=function(a){var b=q(document.querySelectorAll(l));b.forEach(function(a){c.push({el:a,name:a.getAttribute(j),depth:r(a)})}),a(b)},v=function(a){var b=o[a.id];if(b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}return a},w=function(a){var b,c=q(document.querySelectorAll(k)),d=c.map(y);d.forEach(function(a){e[a.type]||(e[a.type]=void 0)}),b=Object.keys(e),b.length>0&&G.attach(x(b),a)},x=function(a,b){var c="comp.js?",d="]",e=b?b:"mode";return c+e+a.join(",")+d},y=function(a){return{el:a,id:a.getAttribute(i),depth:r(a),type:a.getAttribute(h)}},z=function(a,b){return a.depth<b.depth?-1:a.depth>b.depth?1:0},A=function(a,c){if(!a.el.__cosy){var d=n[a.type],e=v(a),f=d.initialize;d.adapter&&!b[d.adapter]&&(f=b[d.adapter]=G.adapters[d.adapter]),c[a.id]=f(a.el,e,c),a.el.__cosy=!0}},B=function(a){var b=q(a.el.querySelectorAll(k)),c=b.map(y);c.sort(z).reverse().forEach(function(b){A(b,a)})},C=function(a){if(!a||!a.type)throw"should have at least a type";n[a.type]=a},D=function(a){p.length>0?G.attach(x(p,"ctrl"),a):a()},E=function(a,b){var c=G.modules(a);return _.isFunction(b)?b.call(c):void 0},F=function(a){w(function(){u(function(){c.sort(z).reverse().forEach(B),D(a)})})},G=a._c={component:C};G="undefined"!=typeof exports?exports:a._c={},G.components=n,G.component=C,G.expose=A,G.init=F,G.attach=t,G.controller=E,G.modules=function(a){var b;return a?(b=c.map(function(b){return~a.indexOf(b.name)?b:null}),m(a)?b:b&&1===b.length?b[0]:null):c.map(function(a){return a})},d&&!g&&F()}(this);